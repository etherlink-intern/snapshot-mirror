version: '3.8'

services:
  snapshot-mirror:
    build: .
    container_name: snapshot-mirror
    restart: unless-stopped
    env_file:
      - .env
    environment:
      - TARGET_DIR=/snapshots
      - KEEP_COUNT=${KEEP_COUNT:-1}
      - SYNC_INTERVAL=${SYNC_INTERVAL:-21600}
    volumes:
      - snapshot-data:/snapshots

volumes:
  snapshot-data:
    driver: local
    driver_opts:
      type: cifs
      device: "//${SYNOLOGY_IP}/${SHARE_NAME}"
      o: "username=${CIFS_USER},password=${CIFS_PASSWORD},vers=3.0,uid=1000,gid=1000"
