version: '3.8'

services:
  snapshot-mirror:
    image: snapshot-mirror:latest
    container_name: snapshot-mirror
    restart: unless-stopped
    env_file:
      - .env
    environment:
      - TARGET_DIR=/snapshots
      - KEEP_COUNT=${KEEP_COUNT:-1}
      - SYNC_INTERVAL=${SYNC_INTERVAL:-21600}
    volumes:
      - snapshot-data:/snapshots

volumes:
  snapshot-data:
    driver: local
    # NOTE: Configure this with your actual network storage (NAS, SAN, etc.)
    # Example 1: SMB/CIFS (Common for Synology/QNAP/Windows)
    # driver_opts:
    #   type: cifs
    #   device: "//${NAS_IP}/${SHARE_NAME}"
    #   o: "username=${STORAGE_USER},password=${STORAGE_PASSWORD},vers=3.0,uid=1000,gid=1000"
    #
    # Example 2: NFS (Common for Linux/TrueNAS)
    # driver_opts:
    #   type: nfs
    #   o: "addr=${NAS_IP},nolock,soft,rw"
    #   device: ":/${EXPORT_PATH}"
